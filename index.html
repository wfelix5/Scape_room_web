<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Escape Room | Saber Logístico</title>

<style>
    :root {
        --app-height: 100vh;
        --color-fondo: #0a0f24;
        --color-primario: #5ca9ff;
        --color-secundario: #e0e6ff;
        --color-exito: #00cc52;
        --color-error: #ff4d4d;
    }

    body {
        margin: 0;
        padding: 0;
        min-height: 100vh; 
        min-height: var(--app-height); 
        background: radial-gradient(circle at center, #1a2647 0%, var(--color-fondo) 100%);
        color: var(--color-secundario);
        font-family: 'Segoe UI', sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        overflow: hidden; 
        user-select: none;
    }

    .container {
        /* Ajuste: un poco más de ancho máximo para dar aire */
        padding: 25px; 
        border-radius: 25px;
        background: rgba(26, 38, 71, 0.85);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 20px var(--color-primario);
        width: 90%;
        max-width: 420px; /* Un poco más ancho */
        text-align: center;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(92, 169, 255, 0.3);
        box-sizing: border-box;
    }

    h1 {
        font-size: 2rem; /* Texto un poco más grande */
        text-align: center;
        color: var(--color-primario);
        text-shadow: 0 0 8px var(--color-primario);
        margin: 0 0 20px 0;
        font-weight: bold;
    }
    
    p {
        font-size: 1.1rem;
        color: var(--color-secundario);
        opacity: 0.9;
        margin-bottom: 20px;
    }

    /* INPUT (Pantalla del código) */
    input {
        margin-bottom: 25px;
        padding: 15px;
        font-size: 2.8rem; /* Números más grandes en pantalla */
        width: 100%;
        box-sizing: border-box;
        border-radius: 12px;
        border: 2px solid var(--color-primario);
        background: #050814;
        color: #fff;
        text-align: center;
        letter-spacing: 12px;
        outline: none;
        box-shadow: inset 0 0 15px rgba(0,0,0,0.8);
        font-family: monospace;
        pointer-events: none;
    }

    /* TECLADO NUMÉRICO (Grid) */
    .keypad {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* 3 columnas iguales */
        gap: 15px; /* MEJORA: Más espacio entre botones */
        margin-bottom: 25px;
        width: 100%; /* MEJORA: Ocupar todo el ancho disponible */
        box-sizing: border-box;
    }

    /* Botones del teclado numérico */
    .key {
        width: 100%; /* Asegura que el botón llene su celda */
        padding: 18px 0; /* Ajuste vertical para que no se vean tan estirados */
        font-size: 1.8rem; /* Números más legibles */
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        border-radius: 12px; /* Bordes más suaves */
        cursor: pointer;
        transition: 0.1s;
        font-weight: bold;
        display: flex; /* Centrado perfecto */
        align-items: center;
        justify-content: center;
    }
    .key:active {
        background: var(--color-primario);
        color: #000;
        transform: scale(0.95);
        border-color: var(--color-primario);
    }

    /* Botón de borrar (C) y retroceso (<) */
    .key-action {
        background: rgba(255, 77, 77, 0.15);
        border-color: rgba(255, 77, 77, 0.3);
        font-size: 1.4rem; /* Iconos un poco más pequeños que los números */
    }
    .key-action:active {
        background: var(--color-error);
        color: white;
    }

    /* Botón Principal (VALIDAR) */
    .btn-main {
        width: 100%;
        padding: 18px;
        font-size: 1.4rem;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        background: var(--color-primario);
        color: #0a0f24; /* Texto oscuro para contraste */
        font-weight: 800; /* Extra negrita */
        box-shadow: 0 0 20px rgba(92, 169, 255, 0.4);
        transition: 0.2s;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .btn-main:active {
        transform: scale(0.98);
        box-shadow: 0 0 10px rgba(92, 169, 255, 0.2);
    }

    /* PANTALLAS FINALES */
    #final h1 {
        font-size: 2.8rem;
        color: var(--color-exito);
        text-shadow: 0 0 20px var(--color-exito);
    }
    #incorrecto h1 {
        font-size: 2.2rem;
        color: var(--color-error);
        text-shadow: 0 0 15px var(--color-error);
    }
    
    #main, #final, #incorrecto {
        display: none;
        flex-direction: column;
        align-items: center;
        width: 100%;
        animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    /* Ajustes para móviles muy pequeños */
    @media (max-width: 380px) {
        .container { padding: 15px; width: 95%; }
        input { font-size: 2.2rem; letter-spacing: 8px; }
        .key { padding: 15px 0; font-size: 1.5rem; }
        h1 { font-size: 1.5rem; }
    }

</style>
</head>

<body>

<div class="container">
    
    <div id="main">
        <h1>Scape Room</h1>
        <input id="codigo" type="text" placeholder="_____" readonly>
        
        <div class="keypad">
            <button class="key">1</button>
            <button class="key">2</button>
            <button class="key">3</button>
            <button class="key">4</button>
            <button class="key">5</button>
            <button class="key">6</button>
            <button class="key">7</button>
            <button class="key">8</button>
            <button class="key">9</button>
            <button class="key key-action" id="btnBorrarTodo">C</button>
            <button class="key">0</button>
            <button class="key key-action" id="btnBorrarUno">⌫</button>
        </div>

        <button class="btn-main" id="validarBtn">VALIDAR CÓDIGO</button>
    </div>

    <div id="final">
        <h1>¡HAS LOGRADO ESCAPAR!</h1>
        <button class="btn-main" style="background: var(--color-exito); color: #0a0f24;" id="reiniciarBtn">SALIR</button>
    </div>

    <div id="incorrecto">
        <h1>CÓDIGO INCORRECTO</h1>
        <p>El código introducido no es correcto, por favor vuelve a intentarlo.</p>
        <button class="btn-main" style="background: var(--color-error); color: white;" id="reintentarBtn">REINTENTAR</button>
    </div>

</div>

<script>
const codigoCorrecto = "70317";

// Inicialización
document.getElementById("main").style.display = "flex";

// FIX Altura iOS
const setAppHeight = () => {
    document.documentElement.style.setProperty('--app-height', `${window.innerHeight}px`);
}
setAppHeight();
window.addEventListener('resize', setAppHeight);

// --- LÓGICA DEL TECLADO ---
const input = document.getElementById("codigo");

function agregarNumero(num) {
    if (input.value.length < 5) {
        input.value += num;
    }
}

function borrarTodo() {
    input.value = "";
}

function borrarUno() {
    input.value = input.value.slice(0, -1);
}

// Asignar eventos a las teclas
document.querySelectorAll('.key').forEach(boton => {
    if (!boton.id) {
        const numero = boton.innerText;
        boton.addEventListener('click', () => agregarNumero(numero));
        boton.addEventListener('touchend', (e) => {
            e.preventDefault();
            agregarNumero(numero);
        });
    }
});

// Botones de acción (C y Borrar)
const btnC = document.getElementById("btnBorrarTodo");
const btnBack = document.getElementById("btnBorrarUno");

btnC.addEventListener('click', borrarTodo);
btnC.addEventListener('touchend', (e) => { e.preventDefault(); borrarTodo(); });

btnBack.addEventListener('click', borrarUno);
btnBack.addEventListener('touchend', (e) => { e.preventDefault(); borrarUno(); });


// --- VALIDACIÓN ---
function verificar() {
    const val = input.value;
    if (val === codigoCorrecto) {
        cambiarPantalla("final");
    } else {
        cambiarPantalla("incorrecto");
    }
}

function reiniciar() {
    input.value = "";
    cambiarPantalla("main");
}

function reintentar() {
    input.value = "";
    cambiarPantalla("main");
}

function cambiarPantalla(idMostrar) {
    document.getElementById("main").style.display = "none";
    document.getElementById("final").style.display = "none";
    document.getElementById("incorrecto").style.display = "none";
    document.getElementById(idMostrar).style.display = "flex";
}

// Botones Principales
const validarBtn = document.getElementById("validarBtn");
const reiniciarBtn = document.getElementById("reiniciarBtn");
const reintentarBtn = document.getElementById("reintentarBtn");

validarBtn.addEventListener('click', verificar);
reiniciarBtn.addEventListener('click', reiniciar);
reintentarBtn.addEventListener('click', reintentar);

// FIX iOS
validarBtn.addEventListener('touchend', (e) => { e.preventDefault(); verificar(); });
reiniciarBtn.addEventListener('touchend', (e) => { e.preventDefault(); reiniciar(); });
reintentarBtn.addEventListener('touchend', (e) => { e.preventDefault(); reintentar(); });

</script>

</body>
</html>
